{% if page.layout != 'index' %}
{% assign posts=site.posts | where:"lang-ref", page.lang-ref | sort: 'lang' %}
{% if posts.size == 0 %}
    {% assign posts=site.pages | where:"lang-ref", page.lang-ref | sort: 'lang' %}
{% endif %}
{% if posts.size > 1 %}
<div class="lang-options">
    <em>Read this page in a different language:</em>
    <ul>
    {% for post in posts %}
    {% if post.lang != page.lang %}
    {% assign lang=post.lang | default:"zh" %}
    <li><a href="{{ site.base-url }}{{ post.url }}" class="{{ lang }}" title="View in {{ site.data.languages[lang].label }}">{{ site.data.languages[lang].icon }} {{ site.data.languages[lang].label }}</a></li>
    {% endif %}
    {% endfor %}
    </ul>
</div>
{% endif %}
{% endif %}